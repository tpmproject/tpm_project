<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="tpm.work">
	<select id="categoryList" parameterType="tpm.category.model.CategoryDTO" resultType="tpm.category.model.CategoryDTO">
		select * from tpm_category where project_idx=#{project_idx}
	</select>
	<select id="workList" parameterType="tpm.work.model.WorkDTO" resultType="tpm.work.model.WorkDTO">
		select * from tpm_work where category_idx=#{category_idx}
	</select>
	<select id="workMember" parameterType="tpm.member.model.MemberDTO" resultType="tpm.member.model.MemberDTO">
		select member_name from tpm_member
		where member_idx in 
		(select member_idx from tpm_work_member where work_idx=#{work_idx})
	</select>
	<select id="projectMember" parameterType="tpm.category.model.CategoryDTO" resultType="tpm.member.model.MemberDTO">
		select * from tpm_member where member_idx in
		(select member_idx from tpm_project_member where project_idx in
		(select project_idx from tpm_category 
		where category_idx=#{category_idx}))
	</select>
	
	<update id="updateChecklist">
	update tpm_checklist
	set checklist_state=
    	(select mod(checklist_state+1,2) from tpm_checklist
    	where checklist_idx=#{checklist_idx})
	where checklist_idx=#{checklist_idx}
	</update>
</mapper>