<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="tpm.tendency">

	<select id="SelfTendency" parameterType="int" resultType="tpm.tendency.model.TendencyDTO">
		select * from tpm_tendency
		where member_idx = #{member_idx} and project_idx = 0
	</select>

	<select id="TeamTendency" parameterType="int" resultType="tpm.tendency.model.TendencyDTO">
		select a.*
		from (select project_idx, count(*), avg(tendency_e) as tendency_e, avg(tendency_i) as tendency_i, avg(tendency_s) as tendency_s, avg(tendency_n) as tendency_n, avg(tendency_t) as tendency_t, avg(tendency_f) as tendency_f, avg(tendency_j) as tendency_j, avg(tendency_p) as tendency_p
			  from tpm_tendency
			  where member_idx = 3 and project_idx <![CDATA[>]]> 0
			  group by project_idx) a
		where project_idx = 2
	</select>
</mapper>