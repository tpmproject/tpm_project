<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="tpm.tendency">

	<select id="SelfTendency" parameterType="int" resultType="tpm.tendency.model.TendencyDTO">
		select * from tpm_tendency
		where member_idx = #{member_idx} and project_idx = 0
	</select>

	<select id="TeamTendency" parameterType="int" resultType="tpm.tendency.model.TendencyDTO">
		select mytendency.* 
		from (select project_idx, count(*), sum(tendency_e) as Team_e, sum(tendency_i)/count(*) as team_i, sum(tendency_s)/count(*) as team_s, sum(tendency_n)/count(*) as team_n, sum(tendency_t)/count(*) as team_t, sum(tendency_f)/count(*) as team_f, sum(tendency_j)/count(*) as team_j, sum(tendency_p)/count(*) as team_p
			  from tpm_tendency
			  where member_idx = #{member_idx} and project_idx <![CDATA[>]]> 0
			  group by project_idx) mytendency
		where project_idx = 2
	</select>
</mapper>